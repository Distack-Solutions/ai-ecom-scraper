
{% extends 'volt/inc/base.html' %} 
{% load static %}
{% block content %}

<div class="row align-items-center pt-4 my-4">
  <div class="col-md-6 col-12 mb-3 mb-md-0">
    <h1 class="h2">Process Monitoring</h1>
  </div>
  <div
    class="col-md-6 col-12 d-flex justify-content-md-end justify-content-center"
  >
    <a href="{% url 'scraper:initiate-process' %}" type="button" class="btn btn-primary px-4">
      Scrap Products
    </a>
  </div>
</div>

<div class="card border-light shadow-sm mb-4">
  <div class="card-body">
    <div class="row align-items-center my-0">
      <div class="col-md-6 col-12 mb-3 mb-md-0">
        <div class="d-flex align-items-center">
          <form
            class="navbar-search form-inline w-50 me-2"
            id="navbar-search-main"
          >
            <div class="input-group input-group-merge search-bar">
              <input
                type="text"
                class="form-control"
                id="topbarInputIconLeft"
                placeholder="Search"
                aria-label="Search"
                aria-describedby="topbar-addon"
              />
            </div>
          </form>
          <button class="btn btn-dark">Filter</button>
        </div>
      </div>
      <div
        class="col-md-6 col-12 d-flex justify-content-md-end justify-content-center"
      >
        <select class="form-select w-25" aria-label="Default select example">
          <option selected>1</option>
          <option value="1">2</option>
          <option value="2">3</option>
          <option value="3">4</option>
        </select>

        <p class="my-auto mx-2">Entries per page</p>
      </div>
    </div>
  </div>
  <div class="">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-centered table-nowrap mb-0">
          <thead class="thead-light">
            <tr>
              <th class="border-0">ID</th>
              <th class="border-0">Search Query</th>
              <th class="border-0">Website Source</th>
              <th class="border-0">Status</th>
              <th class="border-0">Duration</th>
            </tr>
          </thead>
          <tbody>
            <!-- Item -->
            {% if not processes %}
            <tr class="border-bottom">
              <td class="border-0 fw-bold" colspan="7">
                <p class="text-center">No Scraping Process Initiated yet</p>
              </td>
            </tr>
            {% endif %}

            {% for process in processes %}
            <tr class="border-bottom">
              <td class="border-0 fw-bold">{{ forloop.counter }}</td>
              <td class="border-0 fw-bold">
                
                <p class=" fs-5">{{ process.search_query }}</p>
                (Max record: {{ process.max_records }})
                (Started By: {{ process.started_by }})
              </td>
              <td class="border-0 fw-bold">
                {% for website in process.source_websites.all %}
                  <span class="badge bg-gray-700 text-white p-1 px-2">{{ website.name }}</span>
                {% endfor %}
              </td>
              <td class="border-0 fw-bold my-auto">
                <span class="badge status-{{ process.status }} p-1 px-2">{{ process.get_status_display }}</span>
              </td>
              <td class="border-0 fw-bold">
                <p><b>From</b> {{ process.started_at }}</p>
                <p><b>To</b> {{ process.completed_at }}</p>
              </td>
            </tr>
            {% endfor %}

            <!-- End of Item -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

{% endblock content %}
